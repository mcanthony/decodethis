function Test(t,e){t&&(this.data=t,this.onFinish=null,this.onProgress=null,this.onReset=null,this.percentComplete=0,this.start=function(){self=this,this.status="running",loadanddecode(this.data.path+this.data.filename,function(t,e){self.status="complete","function"==typeof self.onFinish&&self.onFinish(t,e)},function(t){t.lengthComputable&&(self.percentComplete=Math.round(100*t.loaded/t.total)),"function"==typeof self.onProgress&&self.onProgress(self.percentComplete)},e)},this.reset=function(){this.status="init",this.percentComplete=0,"function"==typeof this.onReset&&this.onReset()},this.status="init")}
function loadanddecode(n,o,t,e){e||(window.AudioContext=window.AudioContext||window.webkitAudioContext,e=new AudioContext);var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=function(){200===r.status||304===r.status?e.decodeAudioData(r.response,function(n){"function"==typeof o&&o(null,n)},function(){"function"==typeof o&&o(new Error("Decoding Error"),null)}):"function"==typeof o&&o(new Error("Loading Error : "+r.status),null)},r.onerror=function(){"function"==typeof o&&o(new Error("Loading Error : "+r.status),null)},r.onprogress=function(n){"function"==typeof t&&t(n)},r.send()}
window.addEventListener("load",function(){function n(n,e){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="json",t.onload=function(){"function"==typeof e&&e(t.response)},t.error=function(){"function"==typeof e&&e(null)},t.send()}function e(n){n.path=i;var e=new Test(n,r);return console.log(e),e}function t(n){var e=document.createElement("div");e.id=n.data.filename;var t=document.createElement("button");t.innerHTML="▶",t.id="startbutton";var i=document.createElement("div");i.innerHTML=n.data.filename;var o=document.createElement("div");o.innerHTML="0%";var r=document.createElement("div");return r.innerHTML=n.status,t.addEventListener("click",function(){"init"==n.status?(n.onFinish=function(n,e){r.innerHTML=n?n.toString():e.toString(),t.innerHTML="<"},n.onProgress=function(n){o.innerHTML=n+"%"},n.onReset=function(){t.innerHTML="▶"},n.start()):"complete"==n.status&&(n.reset(),n.start())}),e.appendChild(t),e.appendChild(i),e.appendChild(o),e.appendChild(r),e}var i="audio/",o="files.json";window.AudioContext=window.AudioContext||window.webkitAudioContext;var r=new window.AudioContext,d=document.getElementById("testlist"),a=[];n(i+o,function(n){n.files.forEach(function(n){var i=e(n);a.push(i),d.appendChild(t(i))})})});