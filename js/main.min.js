function Test(t,e){t&&(this.data=t,this.onFinish=null,this.onProgress=null,this.onReset=null,this.percentComplete=0,this.start=function(){self=this,this.status="running",loadanddecode(this.data.path+this.data.filename,function(t,e){self.status="complete","function"==typeof self.onFinish&&self.onFinish(t,e)},function(t){t.lengthComputable&&(self.percentComplete=Math.round(100*t.loaded/t.total)),"function"==typeof self.onProgress&&self.onProgress(self.percentComplete)},e)},this.reset=function(){this.status="init",this.percentComplete=0,"function"==typeof this.onReset&&this.onReset()},this.status="init")}
function loadanddecode(n,o,t,e){e||(window.AudioContext=window.AudioContext||window.webkitAudioContext,e=new AudioContext);var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=function(){200===r.status||304===r.status?e.decodeAudioData(r.response,function(n){"function"==typeof o&&o(null,n)},function(){"function"==typeof o&&o(new Error("Decoding Error"),null)}):"function"==typeof o&&o(new Error("Loading Error : "+r.status),null)},r.onerror=function(){"function"==typeof o&&o(new Error("Loading Error : "+r.status),null)},r.onprogress=function(n){"function"==typeof t&&t(n)},r.send()}
window.addEventListener("load",function(){function e(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="json",t.onload=function(){"function"==typeof n&&n(t.response)},t.error=function(){"function"==typeof n&&n(null)},t.send()}function n(e){e.path=o;var n=new Test(e,d);return console.log(n),n}function t(e){var n=document.createElement("tr");n.className="test",n.id=e.data.filename;var t=document.createElement("td"),o=document.createElement("button");o.innerHTML="▶",o.id="startButton",t.appendChild(o),n.appendChild(t),t=document.createElement("td");var i=document.createElement("div");i.innerHTML=e.data.filename,t.appendChild(i),n.appendChild(t),t=document.createElement("td");var d=document.createElement("div");d.innerHTML="0%",t.appendChild(d),n.appendChild(t),t=document.createElement("td");var a=document.createElement("div");return a.innerHTML=e.status,t.appendChild(a),n.appendChild(t),o.addEventListener("click",function(){"init"==e.status?(e.onFinish=function(e,n){a.innerHTML=e?e.toString():n.toString(),o.innerHTML="<"},e.onProgress=function(e){d.innerHTML=e+"%"},e.onReset=function(){o.innerHTML="▶"},e.start()):"complete"==e.status&&(e.reset(),e.start())}),n}var o="audio/",i="files.json";window.AudioContext=window.AudioContext||window.webkitAudioContext;var d=new window.AudioContext,a=document.getElementById("testlist"),r=[];e(o+i,function(e){e.files.forEach(function(e){var o=n(e);r.push(o),a.appendChild(t(o))})})});